var mongo = require( 'mongodb' );
var mongoUri = process.env.MONGOLAB_URI;

function dbConnectCallback( error, db )
{
    if (!db) return;
    exports.database = database = db;

    database.addListener( "error", handleError );
    database.createCollection( "user_charts", createCollectionCallback );
};

function handleError( error )
{
    console.log( "Error connecting to MongoLab" );
};

function createCollectionCallback( error, collection )
{
    database.collection( "user_charts", collectionCallback )
};

function collectionCallback( error, collection )
{
    exports.collection = collection;
};

mongo.connect( mongoUri, {}, dbConnectCallback );